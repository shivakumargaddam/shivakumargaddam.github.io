---
title: "Periodic boundary conditions and their implementation in ABAQUS"
date: 2025-04-28 22:34:00 +0530
description:  
categories: [Computational mechanics, modelling]
tags: [MATLAB, open-source, polycrystals, micromechanics]
math: true
pin: true
image:
  path: /assets/img/20250428/cover.png
---

> This page is still under development.
{: .prompt-warning }

## Introduction
Periodic boundary conditions (PBCs) are an essential tool in computational mechanics, particularly for simulating materials with repeating microstructures. They are commonly used in modelling representative volume elements (RVEs) of heterogeneous materials, such as composites, polycrystals, and foams.

In this blog, we shall discuss:
- the concept behind periodic boundary conditions,
- the derivation of periodic constraints for a unit cell, and
- their practical implementation in ABAQUS finite element software using the equation constraint option.

---

## Concept of periodic boundary conditions
![Desktop View](/assets/img/20250428/initial.jpg){: width="972" height="589" .w-50 #initial}
_**Figure 1:** Initial configuration_
![Desktop View](/assets/img/20250428/final.jpg){: width="972" height="589" .w-50 #final}
_**Figure 2:** Final configuration_

To apply periodic BCs, the chosen RVE must allow being stacked together to form a macroscopic body with a periodic structure. One example of such an RVE is a cuboid 
block unit cell as shown in [Figure 1](#initial). [Figure 2](#final) represents the RVE in it’s final configuration after the application of periodic boundary conditions.


![Desktop View](/assets/img/20250428/faces.jpg){: width="972" height="589" .w-50 #faces}
_**Figure 3:** Two opposite faces $Z^+$ and $Z^-$ in final configuration._

Each of the two opposing boundaries ([Figure 3](#faces)) represents the RVE in it’s final configuration after the application of periodic boundary conditions.) of the RVE must be related to each other in such a way that they follow the same displacement pattern. This is achieved by tying the related DOF together i.e., the difference between the displacements of two opposite face must be a constant vector. This is expressed in the following 3 sets of equations


$$
\begin{align}
\textbf u^{X^+} - \textbf u^{X^-} &= \textbf p \\
\textbf u^{Y^+} - \textbf u^{Y^-} &= \textbf q \\
\textbf u^{Z^+} - \textbf u^{Z^-} &= \textbf r
\end{align}
$$

where $\textbf p, \textbf q, \textbf r$ are constant vectors

---

## Derivation of constraint equations
In a finite element mesh, the domain is discretized into elements. As a result, the nodes at corners are shared between 3 faces and the nodes on the edges are shared between two faces. This would lead to some redundant constraints on the shared nodes in the above set of equations $(1)-(3)$. These redundant equations can be eliminated by separating the equations $(1)-(3)$ into 3 distinct sets for corners, inner nodes of edges and inner nodes of faces.

For the faces $Z^+$ and $Z^-$, the equations $(3)$ can be separated as

$$
\begin{align*}
\textbf u^{daa'd'} - \textbf u^{cbb'c'} &= \textbf r
\end{align*} \quad\quad \text{for inner nodes of faces}
$$

$$
\begin{align*}
\textbf u^{da} - \textbf u^{cb} &= \textbf r \\
\textbf u^{aa'} - \textbf u^{bb'} &= \textbf r \\
\textbf u^{a'd'} - \textbf u^{b'c'} &= \textbf r \\
\textbf u^{d'd} - \textbf u^{c'c} &= \textbf r 
\end{align*}\quad\quad\text{for inner nodes of edges}
$$

$$
\begin{align*}
\textbf u^{d} - \textbf u^{c} &= \textbf r \\
\textbf u^{a} - \textbf u^{b} &= \textbf r \\
\textbf u^{a'} - \textbf u^{b'} &= \textbf r \\
\textbf u^{d'} - \textbf u^{c'} &= \textbf r
\end{align*}\quad\quad\text{for corner nodes}
$$

similarly equations $(2),(3)$ can also be separated for corners, edges and faces. The complete sets of equations are given below

### **Set-I (corner nodes)**

**For the faces $X^+$ and $X^-$**

$$
\begin{align}
\textbf u^{b} - \textbf u^{c} &= \textbf p \\
\textbf u^{b'} - \textbf u^{c'} &= \textbf p \\
\textbf u^{a'} - \textbf u^{d'} &= \textbf p \\
\textbf u^{a} - \textbf u^{d} &= \textbf p \\
\end{align}
$$

**For the faces $Y^+$ and $Y^-$**

$$
\begin{align}
\textbf u^{c'} - \textbf u^{c} &= \textbf q \\
\textbf u^{d'} - \textbf u^{d} &= \textbf q \\
\textbf u^{a'} - \textbf u^{a} &= \textbf q \\
\textbf u^{b'} - \textbf u^{b} &= \textbf q
\end{align}
$$

**For the faces $Z^+$ and $Z^-$**

$$
\begin{align}
\textbf u^{d} - \textbf u^{c} &= \textbf r \\
\textbf u^{a} - \textbf u^{b} &= \textbf r \\
\textbf u^{a'} - \textbf u^{b'} &= \textbf r \\
\textbf u^{d'} - \textbf u^{c'} &= \textbf r
\end{align}
$$

$$
\begin{align*}
(4)&\implies\textbf u^{b} - \textbf u^{c} = \textbf p \\
(5)&\implies\textbf u^{b'} - \textbf u^{c'} = \textbf p \implies \textbf u^{b'} - \textbf u^{c'} = \textbf u^{b} - \textbf u^{c} \\
(6)&\implies\textbf u^{a'} - \textbf u^{d'} = \textbf p \implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{b} - \textbf u^{c} \\
(7)&\implies\textbf u^{a} - \textbf u^{d} = \textbf p \implies \textbf u^{a} - \textbf u^{d} = \textbf u^{b} - \textbf u^{c}
\end{align*}
$$

$$
\begin{align*}
(8)&\implies\textbf u^{c'} - \textbf u^{c} = \textbf q \\

(9)&\implies\textbf u^{d'} - \textbf u^{d} = \textbf q \implies \textbf u^{d'} - \textbf u^{d} = \textbf u^{c'} - \textbf u^{c}\\

(10)&\implies\textbf u^{a'} - \textbf u^{a} = \textbf q \implies \textbf u^{a'} - \textbf u^{a} = \textbf u^{d'} - \textbf u^{d} \implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{a} - \textbf u^{d} \implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{b} - \textbf u^{c}\implies(6)\quad\text{redundant}\\

(11)&\implies\textbf u^{b'} - \textbf u^{b} = \textbf q \implies \textbf u^{b'} - \textbf u^{b} = \textbf u^{c'} - \textbf u^{c}\implies \textbf u^{b'} - \textbf u^{c'} = \textbf u^{b} - \textbf u^{c} \implies (5)\quad\text{redundant}\\
\end{align*}
$$

$$
\begin{align*}
(12)&\implies\textbf u^{d} - \textbf u^{c} = \textbf r \\

(13)&\implies\textbf u^{a} - \textbf u^{b} = \textbf r \implies \textbf u^{a} - \textbf u^{b} = \textbf u^{d} - \textbf u^{c}\implies \textbf u^{a} - \textbf u^{d} = \textbf u^{b} - \textbf u^{c}\implies(7)\quad\text{redundant}\\

(14)&\implies\textbf u^{a'} - \textbf u^{b'} = \textbf r \implies \textbf u^{a'} - \textbf u^{b'} = \textbf u^{d'} - \textbf u^{c'}\implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{b'} - \textbf u^{c'}\implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{b} - \textbf u^{c}\implies(6)\quad\text{redundant}\\

(15)&\implies\textbf u^{d'} - \textbf u^{c'} = \textbf r \implies \textbf u^{d'} - \textbf u^{c'} = \textbf u^{d} - \textbf u^{c} \implies \textbf u^{d'} - \textbf u^{d} = \textbf u^{c'} - \textbf u^{c}\implies(9)\quad\text{redundant}
\end{align*}
$$

**The remaining equations in Set-I are**

$$
\begin{align*}
(5)&\implies \textbf u^{b'} - \textbf u^{c'} = \textbf u^{b} - \textbf u^{c} \\
(6)&\implies \textbf u^{a'} - \textbf u^{d'} = \textbf u^{b} - \textbf u^{c} \\
(7)&\implies \textbf u^{a} - \textbf u^{d} = \textbf u^{b} - \textbf u^{c}\\
(9)&\implies \textbf u^{d'} - \textbf u^{d} = \textbf u^{c'} - \textbf u^{c}\\
\end{align*}
$$

$$
\begin{align*}
(4)&\implies\textbf u^{b} - \textbf u^{c} = \textbf p \\
(8)&\implies\textbf u^{c'} - \textbf u^{c} = \textbf q \\
(12)&\implies\textbf u^{d} - \textbf u^{c} = \textbf r \\
\end{align*}
$$


### **Set-II (inner nodes of edges)**

**For the faces $X^+$ and $X^-$**

$$
\begin{align}
\textbf u^{bb'} - \textbf u^{cc'} &= \textbf p  \\
\textbf u^{b'a'} - \textbf u^{c'd'} &= \textbf p \\
\textbf u^{a'a} - \textbf u^{d'd} &= \textbf p \\
\textbf u^{ab} - \textbf u^{dc} &= \textbf p \\
\end{align}
$$

**For the faces $Y^+$ and $Y^-$**

$$
\begin{align}
\textbf u^{c'd'} - \textbf u^{cd} &= \textbf q \\
\textbf u^{d'a'} - \textbf u^{da} &= \textbf q\\
\textbf u^{a'b'} - \textbf u^{ab} &= \textbf q\\
\textbf u^{b'c'} - \textbf u^{bc} &= \textbf q\\
\end{align}
$$

**For the faces $Z^+$ and $Z^-$**

$$
\begin{align}
\textbf u^{da} - \textbf u^{cb} &= \textbf r \\
\textbf u^{aa'} - \textbf u^{bb'} &= \textbf r \\
\textbf u^{a'd'} - \textbf u^{b'c'} &= \textbf r \\
\textbf u^{d'd} - \textbf u^{c'c} &= \textbf r \\
\end{align}
$$

$$
\begin{align*}
(16)&\implies\textbf u^{bb'} - \textbf u^{cc'} = \textbf u^{b} - \textbf u^{c} \\

(17)&\implies\textbf u^{b'a'} - \textbf u^{c'd'} = \textbf u^{b} - \textbf u^{c} = \textbf u^{ab} - \textbf u^{dc} \implies \textbf u^{b'a'} - \textbf u^{ab} = \textbf u^{c'd'} - \textbf u^{dc}\implies \textbf u^{b'a'} - \textbf u^{ab} = \textbf u^{c'} - \textbf u^{c}\implies(22)\quad\text{redundant}\\

(18)&\implies\textbf u^{a'a} - \textbf u^{d'd} = \textbf u^{b} - \textbf u^{c} \\

(19)&\implies\textbf u^{ab} - \textbf u^{dc} = \textbf u^{b} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
(20)&\implies\textbf u^{c'd'} - \textbf u^{cd} = \textbf u^{c'} - \textbf u^{c}  \\

(21)&\implies\textbf u^{d'a'} - \textbf u^{da} = \textbf u^{c'} - \textbf u^{c} = \textbf u^{b'c'} - \textbf u^{bc}\implies\textbf u^{d'a'} - \textbf u^{b'c'} = \textbf u^{da} - \textbf u^{bc} \implies\textbf u^{d'a'} - \textbf u^{b'c'} = \textbf u^{d} - \textbf u^{c} \implies (26)\quad\text{redundant}\\

(22)&\implies\textbf u^{a'b'} - \textbf u^{ab} = \textbf u^{c'} - \textbf u^{c} \\

(23)&\implies\textbf u^{b'c'} - \textbf u^{bc} = \textbf u^{c'} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
(24)&\implies\textbf u^{da} - \textbf u^{cb} = \textbf u^{d} - \textbf u^{c}  \\

(25)&\implies\textbf u^{aa'} - \textbf u^{bb'} = \textbf u^{d} - \textbf u^{c} = \textbf u^{d'd} - \textbf u^{c'c} \implies\textbf u^{aa'} - \textbf u^{d'd} = \textbf u^{bb'} - \textbf u^{c'c} \implies\textbf u^{aa'} - \textbf u^{d'd} = \textbf u^{b} - \textbf u^{c}\implies(18)\quad\text{redundant}\\

(26)&\implies\textbf u^{a'd'} - \textbf u^{b'c'} = \textbf u^{d} - \textbf u^{c}  \\

(27)&\implies\textbf u^{d'd} - \textbf u^{c'c} = \textbf u^{d} - \textbf u^{c}  \\
\end{align*}
$$

**The remaining equations in Set-II are**

$$
\begin{align*}
(16)&\implies\textbf u^{bb'} - \textbf u^{cc'} = \textbf u^{b} - \textbf u^{c} \\

(18)&\implies\textbf u^{a'a} - \textbf u^{d'd} = \textbf u^{b} - \textbf u^{c} \\

(19)&\implies\textbf u^{ab} - \textbf u^{dc} = \textbf u^{b} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
(20)&\implies\textbf u^{c'd'} - \textbf u^{cd} = \textbf u^{c'} - \textbf u^{c}  \\

(22)&\implies\textbf u^{a'b'} - \textbf u^{ab} = \textbf u^{c'} - \textbf u^{c} \\

(23)&\implies\textbf u^{b'c'} - \textbf u^{bc} = \textbf u^{c'} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
(24)&\implies\textbf u^{da} - \textbf u^{cb} = \textbf u^{d} - \textbf u^{c}  \\

(26)&\implies\textbf u^{a'd'} - \textbf u^{b'c'} = \textbf u^{d} - \textbf u^{c}  \\

(27)&\implies\textbf u^{d'd} - \textbf u^{c'c} = \textbf u^{d} - \textbf u^{c}  \\
\end{align*}
$$


### **Set-III (inner nodes of faces)**

$$
\begin{align*}
\textbf u^{bb'a'a} - \textbf u^{cc'd'd} &= \textbf p \implies \textbf u^{bb'a'a} - \textbf u^{cc'd'd}  = \textbf u^{b} - \textbf u^{c}\quad \because \text{from eq(4)}\\

\textbf u^{c'd'a'b'} - \textbf u^{cdab} &= \textbf q \implies \textbf u^{c'd'a'b'} - \textbf u^{cdab}  = \textbf u^{c'} - \textbf u^{c}\quad \because \text{from eq(8)}\\
\textbf u^{daa'd'} - \textbf u^{cbb'c'} &= \textbf r\implies \textbf u^{daa'd'} - \textbf u^{cbb'c'}  = \textbf u^{d} - \textbf u^{c}\quad \because \text{from eq(12)}
\end{align*}
$$

---

## Boundary conditions
The boundary conditions for the periodic RVE are set by prescribing the displacement of the corner nodes $b, c', d$ where as node $c$ is constrained to avoid rigid body translations. Hence the equations $(4), (8), (12)$ can be written as follows

$$
\begin{align*}
(4)&\implies\textbf u^{b} - \textbf u^{c} = \textbf p &\implies\textbf u^{b} = \textbf p\\

(8)&\implies\textbf u^{c'} - \textbf u^{c} = \textbf q &\implies\textbf u^{c'} = \textbf q \\

(12)&\implies\textbf u^{d} - \textbf u^{c} = \textbf r &\implies\textbf u^{d} = \textbf r\\
\end{align*}\quad\quad\because\textbf u^c=\textbf 0
$$

Above set of equations can be expressed in matrix form as

$$
\begin{equation}
\implies
\begin{bmatrix}
u_1^b & u_2^b & u_3^b \\
u_1^{c'} & u_2^{c'} & u_3^{c'} \\
u_1^d & u_2^d & u_3^d \\
\end{bmatrix}=
\begin{bmatrix}
p_1 & p_2 & p_3 \\
q_1 & q_2 & q_3 \\
r_1 & r_2 & r_3 \\
\end{bmatrix} = \nabla\textbf{u}^\mathrm{T}\times\text{size of RVE}
\end{equation}
$$

---

## Final form of the Constraint equations for Periodic Boundary Conditions

### Set-I (corners)

$$
\begin{align*}
\textbf u^{b'} - \textbf u^{c'} &= \textbf u^{b}- \textbf u^{c} \\
\textbf u^{a'} - \textbf u^{d'} &= \textbf u^{b}- \textbf u^{c} \\
\textbf u^{a} - \textbf u^{d} &= \textbf u^{b}- \textbf u^{c} \\
\textbf u^{d'} - \textbf u^{d} &= \textbf u^{c'}- \textbf u^{c} \\
\end{align*}
$$

### Set-II (edges)

$$
\begin{align*}
\textbf u^{bb'} - \textbf u^{cc'} = \textbf u^{b} - \textbf u^{c} \\

\textbf u^{a'a} - \textbf u^{d'd} = \textbf u^{b} - \textbf u^{c} \\

\textbf u^{ab} - \textbf u^{dc} = \textbf u^{b} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
\textbf u^{c'd'} - \textbf u^{cd} = \textbf u^{c'} - \textbf u^{c}  \\

\textbf u^{a'b'} - \textbf u^{ab} = \textbf u^{c'} - \textbf u^{c} \\

\textbf u^{b'c'} - \textbf u^{bc} = \textbf u^{c'} - \textbf u^{c} \\
\end{align*}
$$

$$
\begin{align*}
\textbf u^{da} - \textbf u^{cb} = \textbf u^{d} - \textbf u^{c}  \\

\textbf u^{a'd'} - \textbf u^{b'c'} = \textbf u^{d} - \textbf u^{c}  \\

\textbf u^{d'd} - \textbf u^{c'c} = \textbf u^{d} - \textbf u^{c}  \\
\end{align*}
$$

### Set-III (faces)

$$
\begin{align*}
\textbf u^{bb'a'a} - \textbf u^{cc'd'd}  = \textbf u^{b} - \textbf u^{c}\\
\textbf u^{c'd'a'b'} - \textbf u^{cdab}  = \textbf u^{c'} - \textbf u^{c}\\
\textbf u^{daa'd'} - \textbf u^{cbb'c'}  = \textbf u^{d} - \textbf u^{c}
\end{align*}
$$

---

## Boundary conditions for homogenization

**Tension along X-axis**

$$
\begin{bmatrix}
u_0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

**Tension along Y-axis**

$$
\begin{bmatrix}
0 & 0 & 0 \\
0 & u_0 & 0 \\
0 & 0 & 0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

**Tension along Z-axis**

$$
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & u_0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

**Shear on YZ-plane**

$$
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0 & u_0/2 \\
0 & u_0/2 & 0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

**Shear on XZ-plane**

$$
\begin{bmatrix}
0 & 0 & u_0/2\\
0 & 0 & 0 \\
u_0/2& 0 & 0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

**Shear on XY-Plane**

$$
\begin{bmatrix}
0 & u_0/2 & 0 \\
u_0/2 & 0 & 0 \\
0 & 0 & 0 \\
\end{bmatrix}
\quad\text{and}\quad\textbf u^c = \textbf 0
$$

---

## Implementation in ABAQUS